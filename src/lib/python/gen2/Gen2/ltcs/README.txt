This is example working code implementing the LTCS notification system
for Subaru Telescope (NOT a collision avoidance system--just the LTCS
notification compliance system).  It is based on two sources: 

- the "Mauna Kea LTCS URL Interface Specification", ver 2.0, release 1.0

- examination of the Perl/csh/awk/C code written by Ryu Ogasawara for
  the first Subaru implementation.

This code is written entirely in Python and, aside from the SOSS.status
module used to obtain status from SOSS, is completely self-contained in
one file.  There are optional template files in here, but they are not
used by default.

I believe it implements the spec as defined in the "MKLUIS" document
(referred to above), with the exception that the algorithm for
generating the LASER_IMPACTED keyword is based on Ogasawara's original 
algorithm (which hard-codes several constants) and then modified by
suggestions for calculating different FOV for each telescope foci based
on a table provided by Yutaka Hayano and Hideki Takami.  The
algorithm as it stands is very conservative (from Subaru's perspective)
insofar as it errs on the side of LASER_IMPACTED = YES, when more
accurate status cannot be determined.

The code can be run as a CGI script, or (much better) as a standalone
program, to generate an HTML file at a configurable interval.  The
suggested method of implementation is to run the script as a daemon on
an SSD server and scp/rsync the HTML file to the DMZ web server.

A couple of paths need to be set in the ltcs.py program near the top,
depending on where you installed the SOSS.status module.

RUNNING LTCS
------------
You can access the current output of this module via:

http://www.naoj.hawaii.edu:8011/ltcs.html (primary)
http://www2.naoj.hawaii.edu:8011/ltcs.html (secondary)

Currently, the primary file is generated by a program running on
obs2.sum.naoj.org under the account 'ltcs', and copied via scp to
ltcsuser@mko10.naoj.hawaii.edu:/export/home/usr/local/apache2/htdocs/8011/ltcs.html.

The secondary file is generated on mobs2.sim.naoj.org under the account
'ltcs', and copied via scp to
ltcsuser@mkocn2.subaru.nao.ac.jp:/usr/local/apache2/htdocs/8011/ltcs.html

The mko* boxes are simple Sun servers running the apache webserver.  No
special software is required there.

There is a system start/stop script called ~/bin/ltcs that can be used
to start and stop ltcs from the file generation hosts:

[ltcs@obs2]: ltcs start|stop|restart|status

This program just invokes ltcs.py with the correct options.
This same script should be linked from the /etc/init.d directory to
restart the ltcs reporting program if the system reboots.

The ltcs.py program will give you the command line synopsis with:

~/bin/ltcs.py --help

The ssh login for both of these boxes is 'ltcsuser'.

Eric Jeschke  (eric@naoj.org)
2007.06.15

